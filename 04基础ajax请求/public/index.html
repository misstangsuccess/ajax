<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <form action="###">
    请输入要查询的数据
    <input type="text" name="userid" id="user">
    <br>
    <button id="btn">查询</button>
  </form>
  <script>
    //const oBtn=document.querySelector("#btn")
    const oForm=document.querySelector('form');
    const oUser=document.querySelector("#user")
    //表单提交事件
    oForm.onsubmit=function(){
      console.log("发送ajax请求")
      //1实例化对象(ajax请求依赖XMLHttpRequest对象)
      const xhr=new XMLHttpRequest();
      //2打开路径建立连接(open方法三个参数：请求方式，请求地址，同步or异步(true))
      xhr.open("GET",`userinfo?userid=${oUser.value}`,true)
      //3发送请求(使用send方法如果是get请求,则请求的数据放在url上,如果是post请求,则请求数据放在send中)
      xhr.send();
      //4请求状态发生变化,自动触发onreadystatechange事件
      xhr.onreadystatechange=function(){
      /*   readState:ajax请求状态码
            0:初始化状态
            1:open方法打开路径，但是还没有调用send发送请求
            2:send方法调用，并接收了部分响应信息：响应首行和响应头（比如响应状态码）
            3:代表接受了部分响应体（当响应体比较大的时候）
            4:代表响应体接受完毕，请求结束 
      */

        console.log(xhr.readyState)
        //判断请求状态
        if(xhr.readyState===4 && (xhr.status>199 && xhr.status<300)){
          console.log("请求成功接收数据成功")

          //xhr.responseXML:用来接受xml格式的响应
          //xhr.responseText:用来接受json文本等响应
          //转换成json文本响应数据

          console.log(JSON.parse(xhr.responseText))
        }
      }
      //阻止默认事件,阻止表单提交 而是使用ajax提交 
      return false;
    }
  </script>
</body>
</html>